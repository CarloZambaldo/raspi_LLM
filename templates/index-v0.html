<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>The Local LLM Oracle</title>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
	<style>
		body {
			font-family: 'Inter', sans-serif;
			background: linear-gradient(to bottom right, #f3f4f6, #e5e7eb);
			color: #111827;
			margin: 0;
			padding: 0;
			display: flex;
			flex-direction: column;
			align-items: center;
			min-height: 100vh;
		}

		h1 {
			margin-top: 50px;
			font-size: 2rem;
			color: #1f2937;
		}

		#model-selector {
			margin-top: 20px;
			padding: 0.5rem;
			font-size: 1rem;
			border-radius: 8px;
			border: 1px solid #d1d5db;
		}

		textarea {
			width: 90%;
			max-width: 600px;
			padding: 1rem;
			margin-top: 20px;
			border-radius: 12px;
			border: 1px solid #d1d5db;
			resize: vertical;
			font-size: 1rem;
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
		}

		button {
			margin-top: 15px;
			padding: 10px 20px;
			border: none;
			background-color: #6366f1;
			color: white;
			border-radius: 8px;
			font-size: 1rem;
			cursor: pointer;
			transition: background-color 0.3s;
		}

		button:hover {
			background-color: #4f46e5;
		}

		h3 {
			margin-top: 40px;
			color: #374151;
		}

		pre {
			width: 90%;
			max-width: 700px;
			background-color: #f9fafb;
			padding: 1rem;
			border-radius: 10px;
			border: 1px solid #e5e7eb;
			white-space: pre-wrap;
			word-wrap: break-word;
			font-size: 1rem;
			color: #1e293b;
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.03);
		}
	</style>
	<script src="{{ url_for('static', filename='script.js') }}"></script>
</head>
<body>
	<h1>Ask the Local Oracle</h1>
	
	<select id="model-selector">
		<option disabled selected>Loading models...</option>
	</select>

	<textarea id="input" rows="4" placeholder="Write your question here..."></textarea><br>
	<button onclick="send()">Ask the Oracle</button>
	
	<h3>Answer:</h3>
	<pre id="response">Waiting for the Oracle...</pre>

	<script>
		async function loadModels() {
			const selector = document.getElementById("model-selector");
			try {
				const res = await fetch("/models");
				const models = await res.json();
				selector.innerHTML = "";
				models.forEach((model, i) => {
					const option = document.createElement("option");
					option.value = model;
					option.textContent = model;
					if (i === 0) option.selected = true;  // Select the first model by default
					selector.appendChild(option);
				});
			} catch (error) {
				selector.innerHTML = "<option disabled>Error loading models</option>";
			}
		}


		async function send() {
			const input = document.getElementById("input").value;
			const model = document.getElementById("model-selector").value;
			const responseElem = document.getElementById("response");
			responseElem.textContent = "üîÆ The Oracle is thinking...";

			try {
				const res = await fetch('/ask', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json'
					},
					body: JSON.stringify({ question: input, model: model })
				});
				const data = await res.json();
				responseElem.textContent = data.answer || "No answer received.";
			} catch (error) {
				responseElem.textContent = `‚ö†Ô∏è Error: ${error.message}`;
			}
		}

		loadModels();
	</script>
</body>
</html>
